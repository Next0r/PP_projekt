@model BedAndBreakfast.Models.AnnouncementViewModel
@using BedAndBreakfast.Data
@{
    ViewData["Title"] = "DisplaySingle";
    List<string> announcementTypes = Enum.GetNames(typeof(EnumeratedDbValues.AnnouncementType)).ToList();
    List<string> houseSubtypes = Enum.GetNames(typeof(EnumeratedDbValues.HouseSubtype)).ToList();
    List<string> entertainmentSubtypes = Enum.GetNames(typeof(EnumeratedDbValues.EntertainmentSubtype)).ToList();
    List<string> foodSubtypes = Enum.GetNames(typeof(EnumeratedDbValues.FoodSubtype)).ToList();
    List<string> houseSharedParts = Enum.GetNames(typeof(EnumeratedDbValues.HouseSharedPart)).ToList();

    List<string> contactTypes = Enum.GetNames(typeof(EnumeratedDbValues.ContactType)).ToList();
    List<string> paymentMethods = Enum.GetNames(typeof(EnumeratedDbValues.PaymentMethod)).ToList();

}

<script type="text/javascript" src="~/js/effects.js"></script>
<script type="text/javascript" src="~/js/announcementView.js"></script>
<script type="text/javascript" src="~/js/imageSwiper.js"></script>
<script type="text/javascript" src="~/js/mapboxMaps.js"></script>
<script type="text/javascript" src="~/js/messageSystem.js"></script>
<script type="text/javascript">
    window.onload = function () {
        announcementViewInit();
    }
    function getAnnouncementViewModel() {
        return @Html.Raw(Json.Serialize(Model));
    }
    
</script>

<div>
    @if (Model == null)
    {
        <p>An error occurred while retrieving announcement data.</p>
    }
    else
    {
        <table border="1">
            <tr>
                <td colspan="2" id="announcement-images-container"></td>
            </tr>
            <tr>
                <td>
                    @if (Model.AnnouncementPreviewModel.AverageRating != null)
                    {
                        <p>Rating: </p>
                        <p>@Model.AnnouncementPreviewModel.AverageRating/10</p>
                        <p>Reviews amount: </p>
                        <p>@Model.AnnouncementPreviewModel.ReviewsCount</p>
                    }
                    else
                    {
                        <p>This announcement still do not have any reviews.</p>
                    }
                </td>
                <td rowspan="6">
                    <div id="announcement-map-container"></div>
                </td>
            </tr>
            <tr>
                <td>
                    <p>
                        @announcementTypes[Model.AnnouncementPreviewModel.Type]
                        @switch (Model.AnnouncementPreviewModel.Type)
                        {
                            case 0:
                                @houseSubtypes[Model.AnnouncementPreviewModel.Subtype]
                                @: @houseSharedParts[(int)Model.AnnouncementPreviewModel.SharedPart]
                                break;
                            case 1:
                                @entertainmentSubtypes[Model.AnnouncementPreviewModel.Subtype]
                                break;
                            case 2:
                                @foodSubtypes[Model.AnnouncementPreviewModel.Subtype]
                                break;
                        }
                    </p>
                </td>
            </tr>
            <tr>
                <td>
                    <p id="announcement-address-container">
                        @Model.AnnouncementPreviewModel.Country
                        @Model.AnnouncementPreviewModel.Region
                        @Model.AnnouncementPreviewModel.City
                        @Model.AnnouncementPreviewModel.Street
                        @Model.AnnouncementPreviewModel.StreetNumber
                    </p>
                </td>
            </tr>
            <tr>
                <td>
                    <p>
                        @Model.AnnouncementPreviewModel.Description
                    </p>
                </td>
            </tr>
            <tr>
                <td>
                    <p>Contact info:</p>
                    @foreach (var item in Model.Contacts)
                    {
                        <p>
                            @contactTypes[@item.Type]:
                            @item.Value
                        </p>
                    }
                </td>
            </tr>
            <tr>
                <td>
                    <p>Payment info:</p>
                    @foreach (var item in Model.Payments)
                    {
                        <p>
                            @paymentMethods[@item.Type]:
                            @item.Value
                        </p>
                    }
                </td>
            </tr>
            <tr>
                <td colspan="2" id="announcement-timetable-container"></td>
            </tr>
            <tr>
                <td colspan="2" id="announcement-reservations-container">
                    <div id="announcement-reservation-prototype" hidden>
                        <label>Reservation for: </label>
                        <label class="announcement-reservation-date-container"></label>
                        <label>Amount: </label>
                        <button class="announcement-reservation-decrease-10-button">-10</button>
                        <button class="announcement-reservation-decrease-1-button">-1</button>
                        <input class="announcement-reservation-input-field" type="text" readonly />
                        <button class="announcement-reservation-increase-1-button">+1</button>
                        <button class="announcement-reservation-increase-10-button">+10</button>
                        <button class="announcement-reservation-remove-button">Remove</button>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <button onclick="handleSubmitReservationsButton();">Make reservation</button><span id="announcement-reservation-error-span"></span>
                </td>
            </tr>
            <tr>
                <td colspan="2" id="review-creator-container">
                    <p>
                        <label>Rate: </label>
                        <input size="2" maxlength="2" onchange="handleRateValidation();" id="review-creator-rating-input" type="text" /><span>/10</span>
                        <span id="review-creator-rating-error-span" ></span>

                    </p>
                    <p>
                        <label>Your name: </label>
                        <input maxlength="50" id="review-creator-nickname-input" type="text" /><span id="review-creator-nickname-error-span"></span>
                    </p>
                    <p>
                        <label>Review content: </label><br />
                        <textarea oninput="handleReviewTextareaInput();" cols="100" rows="12" id="review-creator-textarea"></textarea>
                    </p>
                        <p id="review-creator-textarea-counter"></p><span id="review-creator-textarea-error-span"></span>
                    <p>
                        <button onclick="handlePostReviewButtonClick(this);">Post review</button><span id="review-creator-error-span"></span>
                    </p>
                </td>
            </tr>
            <tr>
                <td colspan="2" id="announcement-reviews-container">
                    <div id="announcement-review-prototype" hidden>
                        <p>
                            <label>Rate: </label>
                            <label class="announcement-review-rating-container"></label>
                            <label>Written on: </label>
                            <label class="announcement-review-date-container"></label>
                            <label> by: </label>
                            <label class="announcement-review-name-container"></label>
                        </p>
                        <p class="announcement-review-message-container"></p>
                    </div>
                </td>
            </tr>
        </table>

    }
</div>



